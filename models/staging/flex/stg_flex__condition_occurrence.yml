version: 2
models:
  - name: stg_flex__condition_occurrence
    description: |
      Conditions are records of a Person suggesting the presence of a disease or medical condition stated as a diagnosis, 
      a sign or a symptom, which is either observed by a Provider or reported by the patient.
     
      List of coded conditions for each patient visit discharged within the specified timeframe.
      
      Source table (vtg_diagnosis) ICD10 code is not in the required format - transformation required.
      Conditions can occur in multiple episodes so may have multiple consecutive date ranges. Merging is required.
      Identification of final episode coding is also required.
      
      EPISODE_ID in vtg_episode is a version of visit_number in ud_master.visit.

    columns:
      - name: person_id
        description: generated person_id replacing flex patient id
      - name: episode_start_dt
        description: start of episode
      - name: episode_end_dt
        description: end of episode
      - name: provider_id
        description: provider id in form of consultant code
      - name: source_code
        description: icd 10 code from source table
      - name: last_edit_time
        description: last edit time for visit
      - name: updated_at
        description: last time record updated in omop process
      - name: visit_occurrence_id
        description: visit id from flex
      - name: person_source_value
        description: flex patient id
      - name: visit_number
        description: visit number from flex
      - name: index_nbr
        description: coding position number
      - name: provider_source_value
        description: consultant code
      - name: condition_start_date
        description: start date of condition, derived from first_value partition
      - name: last_date
        description: last date of condition
      - name: latest
        description: latest record identifier
      - name: primary_position
        description: flag if primary diagnosis
